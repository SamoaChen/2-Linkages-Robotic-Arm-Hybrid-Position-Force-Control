clear all;
close all;
% syms theta1 theta2 w1 w2 l1 l1c l2 l2c m1 m2 m3 g alpha2

m1=0.04;
m2=0.2;
m3=0.0;
theta1=0;
theta2=-pi/2;
w1=0;
w2=0;
alpha1=0;
alpha2=0;
alpha=[alpha1,alpha2].';
l1c=0.1;
l1=0.2;
l2c=0.05;
l2=0.1;
g=9.8;

% T1=(m2*(2*l1^2*cos(theta1)^2*alpha1 + 2*l1^2*sin(theta1)^2*alpha1))/2 + (m1*(2*l1c^2*cos(theta1)^2*alpha1 + 2*l1c^2*sin(theta1)^2*alpha1))/2 + (m3*((2*l1*cos(theta1) + 2*l2c*cos(theta1 + theta2))*(l2c*cos(theta1 + theta2)*alpha1 + l2c*cos(theta1 + theta2)*alpha2 - l1*sin(theta1)*w1^2 + l1*cos(theta1)*alpha1 - l2c*sin(theta1 + theta2)*w1*(w1 + w2) - l2c*sin(theta1 + theta2)*w2*(w1 + w2)) + (2*l1*sin(theta1) + 2*l2c*sin(theta1 + theta2))*(l2c*sin(theta1 + theta2)*alpha1 + l2c*sin(theta1 + theta2)*alpha2 + l1*cos(theta1)*w1^2 + l1*sin(theta1)*alpha1 + l2c*cos(theta1 + theta2)*w1*(w1 + w2) + l2c*cos(theta1 + theta2)*w2*(w1 + w2)) - (2*l1*sin(theta1)*w1 + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l2c*cos(theta1 + theta2)*w1 + l2c*cos(theta1 + theta2)*w2 + l1*cos(theta1)*w1) + (2*l2c*cos(theta1 + theta2)*(w1 + w2) + 2*l1*cos(theta1)*w1)*(l1*sin(theta1)*w1 + l2c*sin(theta1 + theta2)*w1 + l2c*sin(theta1 + theta2)*w2)))/2 + g*m3*(l1*cos(theta1) + l2c*cos(theta1 + theta2)) + g*l1*m2*cos(theta1) + g*l1c*m1*cos(theta1);
% T2=(m3*(2*l2c*cos(theta1 + theta2)*(l2c*cos(theta1 + theta2)*alpha1 + l2c*cos(theta1 + theta2)*alpha2 - l1*sin(theta1)*w1^2 + l1*cos(theta1)*alpha1 - l2c*sin(theta1 + theta2)*w1*(w1 + w2) - l2c*sin(theta1 + theta2)*w2*(w1 + w2)) + 2*l2c*sin(theta1 + theta2)*(l2c*sin(theta1 + theta2)*alpha1 + l2c*sin(theta1 + theta2)*alpha2 + l1*cos(theta1)*w1^2 + l1*sin(theta1)*alpha1 + l2c*cos(theta1 + theta2)*w1*(w1 + w2) + l2c*cos(theta1 + theta2)*w2*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l2c*cos(theta1 + theta2)*w1 + l2c*cos(theta1 + theta2)*w2 + l1*cos(theta1)*w1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*sin(theta1)*w1 + l2c*sin(theta1 + theta2)*w1 + l2c*sin(theta1 + theta2)*w2)))/2 - (m3*((2*l2c*sin(theta1 + theta2)*w1 + 2*l2c*sin(theta1 + theta2)*w2)*(l2c*cos(theta1 + theta2)*w1 + l2c*cos(theta1 + theta2)*w2 + l1*cos(theta1)*w1) - (2*l2c*cos(theta1 + theta2)*w1 + 2*l2c*cos(theta1 + theta2)*w2)*(l1*sin(theta1)*w1 + l2c*sin(theta1 + theta2)*w1 + l2c*sin(theta1 + theta2)*w2)))/2 + g*l2c*m3*cos(theta1 + theta2);

% H1=g*m3*(l2c*cos(theta1 + theta2) + l1*cos(theta1)) - (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 + g*l1*m2*cos(theta1) + g*l1c*m1*cos(theta1);
H1=- l1*l2c*m3*sin(theta2)*w2^2 - 2*l1*l2c*m3*w1*sin(theta2)*w2 + g*l2c*m3*cos(theta1 + theta2) + g*l1*m2*cos(theta1) + g*l1*m3*cos(theta1) + g*l1c*m1*cos(theta1);
% H2=(m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*((2*l2c*w1*sin(theta1 + theta2) + 2*l2c*w2*sin(theta1 + theta2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l2c*w1*cos(theta1 + theta2) + 2*l2c*w2*cos(theta1 + theta2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 + g*l2c*m3*cos(theta1 + theta2);
H2=-l2c*m3*(l1*sin(theta2)*w1^2 + 2*l1*w2*sin(theta2)*w1 - g*cos(theta1 + theta2));
%% GENERATING THE MASS MATRIX
% M1=(m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 + (m3*((2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(alpha1*l1*cos(theta1) - l1*w1^2*sin(theta1) + alpha1*l2c*cos(theta1 + theta2) + alpha2*l2c*cos(theta1 + theta2) - l2c*w1*sin(theta1 + theta2)*(w1 + w2) - l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - (2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) + (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(alpha1*l1*sin(theta1) + l1*w1^2*cos(theta1) + alpha1*l2c*sin(theta1 + theta2) + alpha2*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2))))/2 + (m2*(2*alpha1*l1^2*cos(theta1)^2 + 2*alpha1*l1^2*sin(theta1)^2))/2 + (m1*(2*alpha1*l1c^2*cos(theta1)^2 + 2*alpha1*l1c^2*sin(theta1)^2))/2;
% M11=(m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 + (m2*(2*alpha1*l1^2*cos(theta1)^2 + 2*alpha1*l1^2*sin(theta1)^2))/2 + (m1*(2*alpha1*l1c^2*cos(theta1)^2 + 2*alpha1*l1c^2*sin(theta1)^2))/2 - (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) - alpha1*l1*cos(theta1) - alpha1*l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(alpha1*l1*sin(theta1) + l1*w1^2*cos(theta1) + alpha1*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2))))/2
% M11=(m2*(2*l1^2*cos(theta1)^2 + 2*l1^2*sin(theta1)^2))/2 + (m1*(2*l1c^2*cos(theta1)^2 + 2*l1c^2*sin(theta1)^2))/2 + (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 - (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) - l1*cos(theta1) - l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l2c*sin(theta1 + theta2) + l1*sin(theta1) + l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2))))/2;
M11=l1^2*m2 + l1^2*m3 + l1c^2*m1 + l2c^2*m3 + 2*l1*l2c*m3*cos(theta2);
% M12=(m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 - (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + alpha2*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) - alpha2*l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2
% M12=(m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2 - (m3*((2*l1*w1*sin(theta1) + 2*l2c*sin(theta1 + theta2)*(w1 + w2))*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) - (2*l1*w1*cos(theta1) + 2*l2c*cos(theta1 + theta2)*(w1 + w2))*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2)) - (2*l2c*sin(theta1 + theta2) + 2*l1*sin(theta1))*(l2c*sin(theta1 + theta2) + l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) + (2*l2c*cos(theta1 + theta2) + 2*l1*cos(theta1))*(l1*w1^2*sin(theta1) - l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2))))/2;
M12=l2c*m3*(l2c + l1*cos(theta2));
% M2=(m3*(2*l2c*cos(theta1 + theta2)*(alpha1*l1*cos(theta1) - l1*w1^2*sin(theta1) + alpha1*l2c*cos(theta1 + theta2) + alpha2*l2c*cos(theta1 + theta2) - l2c*w1*sin(theta1 + theta2)*(w1 + w2) - l2c*w2*sin(theta1 + theta2)*(w1 + w2)) + 2*l2c*sin(theta1 + theta2)*(alpha1*l1*sin(theta1) + l1*w1^2*cos(theta1) + alpha1*l2c*sin(theta1 + theta2) + alpha2*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2;
% M21=(m3*(2*l2c*sin(theta1 + theta2)*(alpha1*l1*sin(theta1) + l1*w1^2*cos(theta1) + alpha1*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) - alpha1*l1*cos(theta1) - alpha1*l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2
% M21=(m3*(2*l2c*sin(theta1 + theta2)*(l2c*sin(theta1 + theta2) + l1*sin(theta1) + l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) - l1*cos(theta1) - l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2;
M21=l2c*m3*(l2c + l1*cos(theta2));
% M22=(m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + alpha2*l2c*sin(theta1 + theta2) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) - alpha2*l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2
% M22=(m3*(2*l2c*sin(theta1 + theta2)*(l2c*sin(theta1 + theta2) + l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) - l2c*cos(theta1 + theta2) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2 - (m3*(2*l2c*sin(theta1 + theta2)*(l1*w1^2*cos(theta1) + l2c*w1*cos(theta1 + theta2)*(w1 + w2) + l2c*w2*cos(theta1 + theta2)*(w1 + w2)) - 2*l2c*cos(theta1 + theta2)*(l1*w1^2*sin(theta1) + l2c*w1*sin(theta1 + theta2)*(w1 + w2) + l2c*w2*sin(theta1 + theta2)*(w1 + w2)) - 2*l2c*sin(theta1 + theta2)*(w1 + w2)*(l1*w1*cos(theta1) + l2c*w1*cos(theta1 + theta2) + l2c*w2*cos(theta1 + theta2)) + 2*l2c*cos(theta1 + theta2)*(w1 + w2)*(l1*w1*sin(theta1) + l2c*w1*sin(theta1 + theta2) + l2c*w2*sin(theta1 + theta2))))/2;
M22=l2c^2*m3;

M=[M11,M12;
   M21,M22];
%% FORM THE TERM FROM OTHER ACCELERATION AND GRAVITY
H=[H1,H2].';
T=M*alpha+H;


